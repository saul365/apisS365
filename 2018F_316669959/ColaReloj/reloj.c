#include "reloj.h"#include <stdio.h>/*********************************************************				API Reloj_T*********************************************************/Reloj_T* Reloj_New(){	Reloj_T* new =(Reloj_T*) malloc (sizeof(Reloj_T));	return new;}void Reloj_Delete(Reloj_T* this){	if (this)//En vez de assert para evitar una fuga de memoria en caso de tener muchos objetos	{		free(this);		this=NULL;	}}void Reloj_Set(Reloj_T* this,int horas,int minutos,int segundos){	this->hora=ConvertirDecimal(horas,0);	this->minutos=ConvertirDecimal(minutos,0);	this->segundos=ConvertirDecimal(segundos,0);}int Reloj_GetHours(Reloj_T* this){	return ConvertirBCD(this->hora,0);}int Reloj_GetMinutes(Reloj_T* this){	return ConvertirBCD(this->minutos,0);}int Reloj_GetSeconds(Reloj_T* this){	return ConvertirBCD(this->segundos,0);}void Reloj_Incrementar(Reloj_T* this){	size_t temp=this->segundos;	this->segundos=Aumento_Bin(temp);	if (this->segundos== 111100)	{		this->segundos=0;		temp=this->minutos;		this->minutos=Aumento_Bin(temp);		if(this->minutos== 111100)		{			this->minutos=0;			temp=this->hora;			this->hora = Aumento_Bin(temp);			if(this->hora==11000)			{				this->hora=0;			}		}	}}/*********************************************************				Funciones auxiliares*********************************************************/size_t  ConvertirDecimal(int Decimal,int pot){		if(!Decimal)		return 0;	/*if (pot==0)	{		if (Decimal%2)			return 0+ConvertirBCD(Decimal/2,pot+1);		else			return 1+ConvertirBCD(Decimal/2,pot+1);	}*/	int lol= ((Decimal%2)*pow(10,pot))+ConvertirDecimal(Decimal/2,pot+1);	return lol;	/*int sum=0,cont=pot;	while(Decimal)//mientras sea diferente de cero	{			sum+=(Decimal%2)*pow(10,cont++);		Decimal/=2;	}	return sum;*/}int ConvertirBCD(size_t BCD, int pot){	if (!BCD)		return 0;	return ((BCD%10)*pow(2,pot)+ConvertirBCD(BCD/10,pot+1));}size_t Aumento_Bin(size_t BCD){	int pot=0;	while (1)	{		BCD+=1*pow(10,pot);		//printf("%ld%d\n",BCD,pot );				//int lol=(((int)BCD%(int)pow(10,pot+1))/pow(10,pot));		//printf("%d\n",lol );		//if(lol==2)		if ((((int)BCD%(int)pow(10,pot+1))/pow(10,pot))==2)		{			BCD/=pow(10,pot+1);			BCD*=pow(10,pot+1);			//printf("sirve\n");			pot++;		}		else			break;	//printf("%ld\n",BCD );	}	return BCD;}